setwd("~/Documents/MSIM/Spring_2018/498D/info-498D-project")
#Loading the data
#BRFSS_all_data <- sasxport.get("data/LLCP2016XPT/LLCP2016.xpt")
BRFSS_all_data <- sasxport.get("./data/LLCP2016.XPT ")
library(Hmisc)
library(foreign)
library(survey)
library(dplyr)
#Loading the data
#BRFSS_all_data <- sasxport.get("data/LLCP2016XPT/LLCP2016.xpt")
BRFSS_all_data <- sasxport.get("./data/LLCP2016.XPT ")
vars<- c("diabete3", "diabage2", "pdiabtst", "prediab1", "x.state", "x.llcpwt")
diab_data <- BRFSS_all_data[vars]
View(diab_data)
diab_data$diabete3[diab_data$diabete3==7] <- 0
diab_data$diabete3[diab_data$diabete3==9] <- 0
svey_daibete3 <- svydesign(ids=~1 ,strata=diab_data$diabete3, weights=diab_data$x.llcpwt, nest=T, data=diab_data)
svey_mean_daibete3 <- svymean(~daibete3, svey_daibete3, na.rm=TRUE)
svey_mean_daibete3 <- svymean(~diabete3, svey_daibete3, na.rm=TRUE)
diab_data$diabage2[diab_data$diabage2==98] <- 0
diab_data$diabage2[diab_data$diabage2==99] <- 0
svey_diabage2 <- svydesign(ids=~1 ,strata=diab_data$diabage2, weights=diab_data$x.llcpwt, nest=T, data=diab_data)
svey_mean_diabage2 <- svymean(~diabage2, svey_daibage2, na.rm=TRUE)
svey_mean_diabage2 <- svymean(~diabage2, svey_diabage2, na.rm=TRUE)
diab_data$prediab1[diab_data$prediab1==7] <- 0
diab_data$prediab1[diab_data$prediab1==9] <- 0
svey_prediab <- svydesign(ids=~1 ,strata=diab_data$prediab1, weights=diab_data$x.llcpwt, nest=T, data=diab_data)
svey_mean_prediab <- svymean(~prediab1, svey_prediab, na.rm=TRUE)
weighted_stats_diab <- c(svey_mean_daibete3*100,svey_mean_diabage2*100,svey_mean_prediab*100)
net_means_diabetes <- data.frame(Diabetes = c("A", "B", "C"), Weighted = weighted_stats_diab)
View(net_means_diabetes)
diab_data$diabete3[diab_data$diabete3==3] <- 0
diab_data$diabete3[diab_data$diabete3==4] <- 0
#Survey weights
svey_daibete3 <- svydesign(ids=~1 ,strata=diab_data$diabete3, weights=diab_data$x.llcpwt, nest=T, data=diab_data)
svey_mean_daibete3 <- svymean(~diabete3, svey_daibete3, na.rm=TRUE)
weighted_stats_diab <- c(svey_mean_daibete3*100,svey_mean_diabage2*100,svey_mean_prediab*100)
net_means_diabetes <- data.frame(Diabetes = c("A", "B", "C"), Weighted = weighted_stats_diab)
diab_data$diabete3[diab_data$prediab1==3] <- 0
svey_prediab <- svydesign(ids=~1 ,strata=diab_data$prediab1, weights=diab_data$x.llcpwt, nest=T, data=diab_data)
svey_mean_prediab <- svymean(~prediab1, svey_prediab, na.rm=TRUE)
weighted_stats_diab <- c(svey_mean_daibete3*100,svey_mean_diabage2*100,svey_mean_prediab*100)
net_means_diabetes <- data.frame(Diabetes = c("A", "B", "C"), Weighted = weighted_stats_diab)
diab_data$diabete3[diab_data$prediab1==3] <- 0
View(diab_data)
diab_data$prediab1[diab_data$prediab1==7] <- 0
diab_data$prediab1[diab_data$prediab1==9] <- 0
View(diab_data)
diab_data$prediab1[diab_data$prediab1==3] <- 0
svey_prediab <- svydesign(ids=~1 ,strata=diab_data$prediab1, weights=diab_data$x.llcpwt, nest=T, data=diab_data)
svey_mean_prediab <- svymean(~prediab1, svey_prediab, na.rm=TRUE)
weighted_stats_diab <- c(svey_mean_daibete3*100,svey_mean_diabage2*100,svey_mean_prediab*100)
net_means_diabetes <- data.frame(Diabetes = c("A", "B", "C"), Weighted = weighted_stats_diab)
View(net_means_diabetes)
net_means_diabetes <- data.frame(Diabetes = c("Diabetes","Pre-diabetes"), Weighted = weighted_stats_diab)
weighted_stats_diab <- c(svey_mean_daibete3*100,svey_mean_prediab*100)
net_means_diabetes <- data.frame(Diabetes = c("Diabetes","Pre-diabetes"), Weighted = weighted_stats_diab)
net_means_diabetes <- data.frame(Diabetes = c("Diabetes","Pre-diabetes"), Weighted = weighted_stats_diab)
#Wrangling into state-wise weights for diabete3
S1 <- svyby(~diabete3, ~x.state, svey_daibete3, svey_mean_daibete3, na.rm=TRUE)
#Wrangling into state-wise weights for diabete3
S1 <- svyby(~diabete3, ~x.state, svey_daibete3, svey_mean_daibete3, na.rm=TRUE)
#Wrangling into state-wise weights for diabete3
S1 <- svyby(~diabete3, ~x.state, svey_daibete3, svey_mean_daibete3, deff=TRUE, na.rm=TRUE)
#Wrangling into state-wise weights for diabete3
S1 <- svyby(~diabete3, ~x.state, svey_daibete3, svey_mean_daibete3, na.rm=TRUE)
str(diab_data$x.state)
str(diab_data$diabete3)
#Wrangling into state-wise weights for diabete3
S1 <- svyby(~diabete3, ~x.state, FUN =svey_daibete3,svey_mean_daibete3, na.rm=TRUE)
#Wrangling into state-wise weights for diabete3
S1 <- svyby(~diabete3, ~x.state, svey_daibete3, FUN = svey_mean_daibete3, na.rm=TRUE)
#Wrangling into state-wise weights for diabete3
S1 <- svyby(~diabete3, ~x.state,des= svey_daibete3, FUN = svey_mean_daibete3, na.rm=TRUE)
#Wrangling into state-wise weights for diabete3
S1 <- svyby(~diabete3, by=~x.state,des= svey_daibete3, FUN = svey_mean_daibete3, na.rm=TRUE)
#Wrangling into state-wise weights for diabete3
S1 <- svyby(~diabete3, by=~x.state,design = svey_daibete3, FUN = svey_mean_daibete3, na.rm=TRUE)
#Wrangling into state-wise weights for diabete3
S1 <- svyby(~diabete3, by=~x.state,design = svey_daibete3, FUN = svey_mean_daibete3, na.rm=TRUE)
#Wrangling into state-wise weights for diabete3
S1 <- svyby(~diabete3, by= ~x.state,design = svey_daibete3, FUN = svey_mean_daibete3, na.rm=TRUE)
S1 <- svyby(~diabete3, ~x.state, svey_daibete3, svey_mean_daibete3, na.rm=TRUE)
S1 <- svyby(~diabete3, ~x.state, svey_daibete3, svymean, na.rm=TRUE)
View(S1)
df_states_diabetes<-data.frame("Adults with Diabetes by state",S[1], S[2]*100, stringsAsFactors = FALSE)
df_states_diabetes<-data.frame("Adults with Diabetes by state",S1[1], S1[2]*100, stringsAsFactors = FALSE)
names(df_states_diabetes)<-c("Metric","State", "Value")
View(df_states_diabetes)
states <- c("Alabama",
"Alaska",
"Arizona",
"Arkansas",
"California",
"Colorado",
"Connecticut",
"Delaware",
"District of Columbia",
"Florida",
"Georgia",
"Hawaii",
"Idaho",
"Illinois",
"Indiana",
"Iowa",
"Kansas",
"Kentucky",
"Louisiana",
"Maine",
"Maryland",
"Massachusetts",
"Michigan",
"Minnesota",
"Mississippi",
"Missouri",
"Montana",
"Nebraska",
"Nevada",
"New Hampshire",
"New Jersey",
"New Mexico",
"New York",
"North Carolina",
"North Dakota",
"Ohio",
"Oklahoma",
"Oregon",
"Pennsylvania",
"Rhode Island",
"South Carolina",
"South Dakota",
"Tennessee",
"Texas",
"Utah",
"Vermont",
"Virginia",
"Washington",
"West Virginia",
"Wisconsin",
"Wyoming",
"Guam",
"Puerto Rico",
"Virgin Islands")
df_states_diabetes <- cbind(states, df_states_diabetes)
State_name <- c("Alabama",
"Alaska",
"Arizona",
"Arkansas",
"California",
"Colorado",
"Connecticut",
"Delaware",
"District of Columbia",
"Florida",
"Georgia",
"Hawaii",
"Idaho",
"Illinois",
"Indiana",
"Iowa",
"Kansas",
"Kentucky",
"Louisiana",
"Maine",
"Maryland",
"Massachusetts",
"Michigan",
"Minnesota",
"Mississippi",
"Missouri",
"Montana",
"Nebraska",
"Nevada",
"New Hampshire",
"New Jersey",
"New Mexico",
"New York",
"North Carolina",
"North Dakota",
"Ohio",
"Oklahoma",
"Oregon",
"Pennsylvania",
"Rhode Island",
"South Carolina",
"South Dakota",
"Tennessee",
"Texas",
"Utah",
"Vermont",
"Virginia",
"Washington",
"West Virginia",
"Wisconsin",
"Wyoming",
"Guam",
"Puerto Rico",
"Virgin Islands")
df_states_diabetes <- cbind(State.name, df_states_diabetes)
df_states_diabetes <- cbind(State_name, df_states_diabetes)
S2 <- svyby(~prediab1, ~x.state, svey_prediab, svymean, na.rm=TRUE)
S2 <- svyby(~prediab1, ~x.state, svey_prediab, svymean, na.rm=TRUE)
S2 <- svyby(~prediab1, ~x.state, svey_prediab, svymean, na.rm=TRUE)
svey_prediab <- svydesign(ids=~1 ,strata=diab_data$prediab1, weights=diab_data$x.llcpwt, nest=T, data=diab_data)
S2 <- svyby(~prediab1, ~x.state, svey_prediab, svymean, na.rm=TRUE)
S2 <- svyby(~prediab1, ~x.state, svey_prediab, svymean)
S2 <- svyby(~prediab1, ~x.state, svymean, na.rm=TRUE)
S2 <- svyby(~prediab1, ~x.state, svey_prediab, svymean, na.rm=TRUE)
S2 <- svyby(~prediab1, ~x.state, svey_prediab, svymean)
S2 <- svyby(~prediab1, ~x.state[4], svey_prediab, svymean, na.rm=TRUE)
View(S2)
S2 <- svyby(~prediab1, ~x.state, svey_prediab, svymean, na.rm=TRUE)
S2 <- svyby(~prediab1, ~x.state, subset(svey_prediab,x.state!=4), svymean, na.rm=TRUE)
S2 <- svyby(~prediab1, ~x.state, subset(svey_prediab,prediab1!=NA), svymean, na.rm=TRUE)
S2 <- svyby(~prediab1, ~x.state, svey_prediab, svymean, na.rm=TRUE)
